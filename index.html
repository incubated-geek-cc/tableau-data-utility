<!DOCTYPE html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Generate Network Graph Data for Tableau</title>
    <link rel="icon" type="image/png" href="img/favicon32x32.png" sizes="32x32">
    <link href="css/bootstrap.min.css" type="text/css" rel="stylesheet" />
    <script src="js/jquery-2.0.0b1.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.json-viewer.js"></script>
    <script src="js/popper.min.js"></script>
    <link href="css/jquery.json-viewer.css" type="text/css" rel="stylesheet" />
    <link href="css/custom.css" type="text/css" rel="stylesheet" />
</head>
<body>
    <div class="container">  
        <ul class="action-segments list-group list-group-flush">
            <h2 class="title">Generate Network Graph Data for Tableau</h2>
            <blockquote class="blockquote-reverse">
                Based on <a href="https://observablehq.com/@ladataviz/network-data-generator" target="blank">Network data generator for Tableau</a> 
                <footer>by <a href="https://observablehq.com/@ladataviz" target="blank">Tristan Guillevin</a></footer>

            </blockquote>
            <div class="card border-top-0 border-right-0 border-left-0">
                <div class="card-body">
                    <h4 class="card-title">Required structure of JSON file:</h4>
                    <p class="card-text">
                        – nodes: with required <code>id</code> fields<br/>
                        – links: with required <code>source</code> and <code>target</code> fields
                    </p>
                    <textarea class="jsonTree" disabled>
                    { 
                     "nodes": [
                        { "id": A },
                        { "id": B }
                      ],
                      "links": [
                        { "source": A, "target": B }
                      ]
                    }
                    </textarea>
                </div>
                <p class="card-title">
                    Here are some sample files you may download:<br />
                    ▸ <a href="data/songs.json" target="blank">songs.json</a><br />
                    ▸ <a href="data/stackoverflow.json" target="blank">stackoverflow.json</a>
                </p>
            </div>
            <p class="card-title">
                To input your own data to generate the required csv files, please proceed to input your JSON file below.
            </p>
            <li class="list-group-item list-group-item-secondary">
                <span><b>data = </b></span><input id="inputJsonFile" type="file" class="form-control-file border" name="file" />
            </li>
            <li class="list-group-item list-group-item-light">
                <span><b>data = </b></span><pre id="json-renderer"></pre>
                <textarea id="json-input" autocomplete="off" style="display:none"></textarea>
            </li>
            <li class="list-group-item list-group-item-light">
                <span><b>Download nodes.csv</b></span>
                <button id="exportNodesData" value="nodes.csv" type="button" class="btn btn-sm btn-outline-secondary">
                    <span class="spinner-border spinner-border-sm"></span>
                    Loading...
                </button>
            </li>
            <li class="list-group-item list-group-item-light">
                <span><b>Download links.csv</b></span>
                <button id="exportLinksData" value="links.csv" type="button" class="btn btn-sm btn-outline-secondary">
                    <span class="spinner-border spinner-border-sm"></span>
                    Loading...
                </button>
            </li>
            <li class="list-group-item list-group-item-secondary">
                <span><b>Implementation Example = </b></span>
                <button type="button" class="btn btn-default btn-xs" data-toggle="popover" title="Tableau Implementation" data-placement="auto right" data-content='<div class="row">
                            <div class="col-md-12" style="text-align:center">
                                <h4><b><small>Tableau Data Join</small></b></h4>
                                <img src="img/tableau_network_graph_data_join.png" height="150px" alt="tableau_network_graph_data_join" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6" style="text-align:center">
                                <h4><b><small>Network Graph Layout Preview</small></b></h4>
                                <img src="img/network_graph_layout_preview.png" height="140px" alt="network_graph_layout_preview" />
                            </div>
                            <div class="col-md-6" style="text-align:center">
                                <h4><b><small>Network Graph in Tableau</small></b></h4>
                                <img src="img/network_graph_in_tableau.png" height="140px" alt="network_graph_in_tableau" />
                            </div>
                        </div>'>
                    <img src="img/tableau_icon.png" width="25px" alt="tableau_icon" />
                </button>
            </li>
            <p class="card-title">
                To alter the layout of your network graph, feel free to configure the various parameters below. The preview will refresh itself automatically. When configurations are finally finalised, you may proceed to download the CSV files above.
            </p>
            <li class="list-group-item">
                <h4>Node</h4>
                <h5>Size (<span id="nodesizecaption">5</span>)</h5>
                <div class="form-group">
                  <input id="nodesize" type="range" class="form-control-range" name="nodesizerange" min="1" max="20" step="1" value="5" />
                </div>
                <h5>Distance (<span id="nodedistancecaption">30</span>)</h5>
                <div class="form-group">
                  <input id="nodedistance" type="range" class="form-control-range" name="nodedistancerange" min="1" max="200" step="1" value="30" />
                </div>
                <h4>Force</h4>
                <h5>Strength (<span id="nodestrengthcaption">90</span>)</h5>
                <div class="form-group">
                  <input id="nodestrength" type="range" class="form-control-range" name="nodestrength" min="0" max="250" step="1" value="90" />
                </div>
                <h5>Collide (<span id="nodecollidecaption">1</span>)</h5>
                <div class="form-group">
                    <input id="nodecollide" type="range" class="form-control-range" name="nodecollide" min="0" max="250" step="1" value="1" />
                </div>
                <mark><b>Note:</b> To adjust the node positions, select and drag <img src="img/arrow-pointer.svg" alt="node_cursor" /> the nodes directly in the graph below.</mark>
            </li>
            <li class="list-group-item">
                <svg id="networkGraph"></svg>
            </li>
        </ul>
    </div>
    <script src="js/d3.v4.min.js"></script>
    <script src="js/json2csv.js"></script>
    <script src="js/custom.js"></script>
</body>